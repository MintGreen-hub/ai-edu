## 11.7 多项式核函数

多项式核
$$K(\boldsymbol{x}_i, \boldsymbol{x}_j)=[\gamma (\boldsymbol{x}_i \cdot \boldsymbol{x}_j) + r]^d \tag{11.7.1}$$


我们先用多项式核函数验证一下 12.1 小节中的一维非线性问题。

关键的函数调用代码如下：

```python
def poly_svc_1(X, Y, d):
    model = SVC(kernel='poly', degree=d)
    model.fit(X,Y)
```

其中 d 表示多项式的次数，如果不指定的话，缺省值为 3。得到的分类结果如图 12.4.2。

<img src="./images/12-4-2.png" />

<center>图 12.4.2 </center>

这是用颜色渐变的方式显示的分类结果，黄色为正类区域，绿色为负类区域。可以看到一个奇怪的现象：degree=2,4,6 时，分类结果是正确的；degree=3,5,7 时，分类结果错误。一个是奇数，一个是偶数。这是为什么呢？

仔细查看 SVC 函数的文档，得知当式 11.7.1 中的 $r$ 不指定时，缺省为 0，具体的参数项名称是 coef0。如果忽略 $\gamma$ 值（在此例中不重要），则式 11.7.1 变为：

$$K(\boldsymbol{x}_i, \boldsymbol{x}_j)=(\boldsymbol{x}_i \cdot \boldsymbol{x}_j)^d, \quad d=2,3,4,5,6,7 \tag{11.7.2}$$

在 12.1 节中，经过试验，确定了式 11.7.3 所示的映射函数是可以完成从线性到非线性的映射的，

$$
f(z)=[z,\ z^2] \tag{12.7.3}
$$

那么下面就可以验证一下当 d=2,3 两种情况时，式 11.7.2 展开为映射函数时，是否与式 12.7.3 一致。注意在本例中是一维特征，所以 $\boldsymbol{x}$ 展开后只有 $x_1$ 项，而不是 $x_1,x_2$ 等等。

- d=2 时

$$
K(\boldsymbol{x}_i, \boldsymbol{x}_j)=(\boldsymbol{x}_i \cdot \boldsymbol{x}_j)^2=(x_{i1} x_{j1})^2=x_{i1}^2 x_{j1}^2
\tag{11.7.4}
$$

所以映射函数是：
$$
\phi(z)=[z^2] 
\tag{11.7.5}
$$

具有 $z^2$ 项特征，对于该问题来说已经足够了，因为原始样本特征值会从 $[-1.5,-1,-0.5,0,0.5,1,1.5]$ 将会变成 $[2.25,1,0.25,0,0.25,1,2.25]$，其中，小于等于 0.25 的样本会被分类为正类，大于等于 1 的样本为负类，具体的分界线值可能是 (0.25,1) 之间的一个数值。

所以 d=2 时可以正确分类。

- d=3 时

$$
K(\boldsymbol{x}_i, \boldsymbol{x}_j)=(\boldsymbol{x}_i \cdot \boldsymbol{x}_j)^3=(x_{i1} x_{j1})^3=x_{i1}^3 x_{j1}^3
\tag{11.7.6}
$$

所以映射函数是：
$$
\phi(z)=[z^3] 
\tag{11.7.7}
$$

根据式 11.7.7，原始样本特征值会从 $[-1.5,-1,-0.5,0,0.5,1,1.5]$ 将会变成 $[-3.375,-1,-0.125,0,0.125,1,3.375]$，读者可以自己在二维坐标系上绘制出这些样本点（横坐标为原始特征值，纵坐标为 $x^3$ 项特征值），实际上就是 $y=x^3$ 的曲线，不是线性可分的。

所以 d=3 时不能正确分类。






$\gamma$ 缺省取值为特征数的倒数，$d$ 一般取值为 2，常用形式为 

$$K(x_i, x_j)=[\gamma(\boldsymbol{x}_i \cdot \boldsymbol{x}_j)+1]^2$$


多项式核 κ(x1,x2)=(〈x1,x2+R)d ，显然刚才我们举的例子是这里多项式核的一个特例（R=1,d=2）。虽然比较麻烦，而且没有必要，不过这个核所对应的映射实际上是可以写出来的，该空间的维度是 (m+dd) ，其中 m 是原始空间的维度。
 

<img src="./images/12-4-1.png" />

<center>图 12.4.1 </center>

